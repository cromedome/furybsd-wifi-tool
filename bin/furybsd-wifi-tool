#!/usr/local/bin/bash

# Only run as superuser
#if [ "$(id -u)" != "0" ]; then
#  echo "This script must be run as root" 1>&2
#  exit 1
#fi

# Function create a dialog for module list
f_create_list () {
    zenity --list --width=640 --height=480 \
    --title="FuryBSD Wifi Tool" \
    --text="Select a kernel module" \
    --column="Module" --column="Description" \
    "if_iwn" "Intel IEEE 802.11n wireless network driver" \
    2>&1 | tee /tmp/fury-wifi-tool.log \

}

# Function create a dialog for firmware list
f_create_fwlist () {
    sed -i -r 's/.*_//' /tmp/fury-wifi-tool.log
    getfw=`cat /tmp/fury-wifi-tool.log`
    find /boot/kernel -name "$getfw*" | cut -d '/' -f4 | cut -d '.' -f1 | zenity --list --title "Search Results" --width=640 --height=480 --text "Finding all firmware modules.." --column "Module"
}

# Main function
f_main () {
    f_create_list 
    f_create_fwlist iwn
}
f_main
